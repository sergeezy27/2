---
title: "MATH250 Final Project - The Weeknd"
author: "Sergei Vorobev"
format: html
embed-resources: true
---

```{r}
#| label: setup
#| message: false

library(tidyverse)
library(here)
library(gt)

path <- here("Data", "the_weeknd.csv")
the_weeknd <- read_csv(path)
```

## Introduction

*The Weeknd* is a Canadian singer who initially gained a lot of fame by posting his mix tapes on the internet in the early 2010s. Since then his fame has skyrocketed. He won Grammy Awards for his performance of the song *Earned It,* and his album *Beauty Behind the Madness*.[^1] He also consistently ranks among Spotify's top ten most-streamed artists each year.

![Abel Makkonen Tesfaye - The Weeknd](the_weeknd.jpg)

Initially, I was introduced to *The Weekend* through his song *The Hills* in middle school, but since I have fallen in love with the magical somber sound of albums ***Kiss Land*** and ***After Hours***. There is no consensus whether the two albums are fundamentally similar. Fans, including myself, view ***Kiss Land*** as a foundational precursor to ***After Hours*** due to their shared dark, cinematic R&B aesthetic. Critics, however, often downplay these similarities, citing ***After Hours*** as a more polished and superior work.[^2]

Dissimilarity in opinion and my personal perception motivate me to determine whether the two albums are similar in sound and the emotional impact. To analyze this, I will examine the following track attributes:

- `energy`: a measure of dynamics, loudness, and intensity.

- `danceability`: reflecting the suitability for dancing, a key factor in pop.

- `valence`: a measure of how positive a track sounds, reflecting the prominence of melancholy in his music.

## Exploratory analysis

```{r}
#| label: data cleaning

albums <- c("Trilogy",
            "Kiss Land",
            "Beauty Behind The Madness",
            "Starboy",
            "My Dear Melancholy,",
            "After Hours",
            "Dawn FM")

the_weeknd_sm <- the_weeknd %>% 
  select(album_name, track_name, energy, danceability, valence) %>% 
  filter(album_name %in% albums) %>% 
  mutate(album_name = factor(album_name, levels = albums))
```

I will only analyze the base version of all studio albums in addition to *My Dear Melancholy,* which is technically an ep, in order to avoid redundancy of deluxe and live versions.

```{r}
#| fig-alt: Different boxplots of energy for each album and ep of The Weeknd.
#| label: energy boxplot

ggplot(the_weeknd_sm,
       aes(x = album_name,
           y = energy,
           fill = album_name)) +
  geom_boxplot(show.legend = FALSE) +
  scale_fill_brewer(palette = "Dark2") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + #https://www.geeksforgeeks.org/rotating-and-spacing-axis-labels-in-ggplot2-in-r/
  labs(x = "Album name",
       y = "Energy",
       title = "The Weeknd album energy")
```

The boxplots are arranged by the albums' release date. It seems as if there is a slight trend of the energy increasing with each subsequent release. It also seems as if ***Kiss Land*** is ahead of its time, deviating from this trend. Energy-wise, the hypothesis is supported, as ***Kiss Land*** and ***After Hours*** show similar levels. Interestingly, ***Kiss Land*** appears closest to *My Dear Melancholy,* in their median energy, aligning with some reviewers' views that tracks like *Privilege* could seamlessly be added to the album without disrupting its style.[^3]

```{r}
#| label: average tables

the_weeknd_summary <- the_weeknd_sm %>% 
  group_by(album_name) %>% 
  summarise("Average energy" = round(mean(energy), 3),
          "Average valence" = round(mean(valence), 3),
          "Average danceability" = round(mean(danceability), 3)) %>% 
  rename("Album name" = album_name)
gt(the_weeknd_summary)
```

On average ***After Hours*** appears to be lower in all three attributes, but still similar. Considering the mean instead of the median the two albums are the most comparable, unlike the previously perceived *My Dear Melancholy,*. Danceability tends to be higher when tracks are happier, as reflected by the correlation between `valence` and `danceability`. However, `energy` does not always align with danceability as some albums with high average `energy` do not show a corresponding increase in `danceability`.

```{r}
#| label: two album cleaning

the_weeknd_moody <- the_weeknd_sm %>% 
  filter(album_name %in% c("Kiss Land", "After Hours"))
```

```{r}
#| fig-alt: Scatter plot of dancebility explained by valence for two of The Weeknd's albums
#| message: false
#| warning: false
#| label: two album scatter plot

ggplot(the_weeknd_moody,
       aes(x = valence,
           y = danceability,
           color = album_name,
           size = energy)) +
  geom_point() +
  geom_smooth(method = "lm",
              se = FALSE,
              aes(group = 1),
              linewidth = 1) +
  scale_color_brewer(palette = "Dark2") +
  guides(size = guide_legend(override.aes = list(linetype = 0))) + #https://aosmith.rbind.io/2020/07/09/ggplot2-override-aes/
  theme_minimal() +
  labs(x = "Valence",
       y = "Danceability",
       title = "Danceability, valence, and energy ",
       color = "Album name",
       size = "Energy")
```

```{r}
#| label: model and track stat tables

model <- lm(danceability ~ valence, data = the_weeknd_moody)
summary(model)

the_weeknd_tracks <- the_weeknd_moody %>% 
  group_by(album_name) %>% 
  summarise("Least danceable song" = track_name[which.min(danceability)],
            "Energy" = energy[which.min(danceability)],
            "Most danceable song" = track_name[which.max(danceability)],
            "Energy" = energy[which.max(danceability)]) %>% 
  rename("Album name" = album_name)
gt(the_weeknd_tracks)
```

The plot confirms that `energy` and `danceability` are unlikely to be correlated. Tracks *Kiss Land* and *Save Your Tears* are drastically different in `danceability`, but their `energy` is similar. For these two albums `valence` seems to explain `danceability` with a linear regression model. 

[^1]: Bauer, Patricia. “The Weeknd | Biography, Songs, Albums, & Facts.” Encyclopedia Britannica, December 3, 2024. <https://www.britannica.com/biography/the-Weeknd>.

[^2]: Herrera, Isabelia. “The Weeknd: After Hours.” Pitchfork, March 24, 2020. <https://pitchfork.com/reviews/albums/the-weeknd-after-hours/>.

[^3]: Luzaityte, Rebeka. “In Defence of Kiss Land - Rebeka Luzaityte - Medium.” Medium, December 8, 2021. <https://medium.com/@rebekalztt/in-defence-of-kiss-land-d472ed155d73>.